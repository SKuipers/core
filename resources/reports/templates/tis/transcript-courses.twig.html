{#<!--
name: Transcript Courses
category: Transcript
types: Body
sources:
    transcript: Transcript
-->#}
{{- stylesheet ? include(stylesheet) -}}

<div style="box-decoration-break: clone;">
<table cellpadding="4" cellspacing="0" style="width: 138mm; border: 0.6pt solid #000000; font-size: 8pt; box-decoration-break: clone;" repeat_header="1">
    <thead style="">
    <tr style="box-decoration-break: clone;">
        <th style="font-weight: normal; width: 10%; text-align: left;">Course ID</th>
        <th style="font-weight: normal; width: 39%; text-align: left;">Course Name</th>
        <th style="font-weight: normal; width: 15%; text-align: center;">School<br/>Year</th>
        <th style="font-weight: normal; width: 10%; text-align: center;">Credit<br/>Awarded</th>
        <th style="font-weight: normal; width: 8%; text-align: center;">Interim<br/>Grade</th>
        <th style="font-weight: normal; width: 8%; text-align: center;">Final<br/>Grade</th>
    </tr>
    </thead>

    <tfoot style="font-size: 0;line-height: 0; height: 0;">
        <tr><td colspan="6" style=""></td></tr>
    <tfoot>   

    <tbody>
    {% set totalCredits = 0 %}
    
    {% for department, courses in transcript %}

        <tr>
            <td colspan="6" style="background-color: #dddddd;page-break-inside: avoid; page-break-before: auto;">
                {{ department }}
            </td>
        </tr>

        {% set count = 0 %}
        {% for course in courses %}
            {% set courseGrade = course.grade is not empty ? course.grade|round|trim('%') : '' %}

            <tr style="background-color: {{ count % 2 == 0 ? '#ffffff' : '#f8f8f8' }}">
                <td style="">{{ course.nameShort }}</td>
                <td style="">{{ course.name }}</td>
                <td style="text-align: center;">{{ course.year }}</td>
                <td style="text-align: center;">{{ course.credits > 0 and not course.interim ? course.credits|round : '' }}</td>
                <td style="text-align: center;">{{ course.interim ? courseGrade : '' }}</td>
                <td style="text-align: center;">{{ not course.interim ? courseGrade : '' }}</td>
            </tr>

            {% set count = count + 1 %}
            {% set totalCredits = not course.interim ? totalCredits + course.credits : totalCredits %}
        {% endfor %}
    {% endfor %}

    <tr>
        <td colspan="3" style="text-align: right; border-top: 0.6pt solid #000000; padding-top: 3mm;">
            {{- "Cumulative Credits:" -}}
        </td>
        <td style="text-align: center; border-top: 0.6pt solid #000000; padding-top: 3mm;">
            {{ totalCredits|round }}
        </td>
        <td colspan="2" style="border-top: 0.6pt solid #000000; padding-top: 3mm;"></td>
    </tr>
    </tbody>
</table>
</div>
